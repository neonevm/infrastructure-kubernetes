## Simple kubernetes setup with k0s.

Requirements:

1. Linux ubuntu based  / Centos. For MacOS, please check this [guide](https://github.com/neonlabsorg/infrastructure-kubernetes/blob/main/docs/k8s-macos.MD)

2. K8s command line tool: [kubectl](https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/)

3. Helm, that is a tool to help you define, install, and upgrade applications running on Kubernetes: [helm](https://helm.sh/docs/intro/install/)

K0s is a popular project and simple way to create kubernetes cluster, and ready for production usage, it's easy and smoothly.

In this guide, we'll give you all information to get started with kubernetes. 

The k0s is a single binary that includes everything that you need to run Kubernetes on any system that includes Linux kernel.

Steps:

1. Download binary.
2. Create a k8s control-plane server.
3. Create and add a worker/node.
4. Acessing the cluster.

You can add additional controlles/nodes/workers, but let's start first with a simple setup.

## Single kubernetes node 

#### Download the binary:

```bash 
sudo curl -sSLf https://get.k0s.sh | sudo sh
````

#### Initiate the controller/worker:

```bash 
sudo k0s install controller --enable-worker
````

#### Install the service:

```bash
sudo k0s start
```

#### Check the status:

```bash
sudo k0s status
```

### Access the k0s cluster

#### Check if your node is ready running;

```bash
sudo k0s kubectl get nodes
```

#### List the defaults namespaces for K0s isntallation:

```bash
sudo k0s kubectl get namespaces
```

## Add additional nodes to the Kubernetes cluster

For scale purposes, you can add multiple workers in your kubernetes cluster. 

You just need to generate a token that can be shared between your nodes/workers.

This token have all information to join the cluster.

First, log in your control-plane/controlle node and generate the "main" token:

```bash
sudo k0s stop
sudo k0s start
k0s token create --role=worker
```

Keep this file in a safe place, this is a base64 encoded file. Now let's log into worker/node and install k0s:

```bash
sudo curl -sSLf https://get.k0s.sh | sudo sh
```

On your worker/node, paste the base64 generated by master node in some file like the following example (/tmp/token.cluster) and...


```bash
sudo k0s install worker --token-file /tmp/token.cluster
sudo k0s stop
sudo k0s start
```

The command above will join your worker into the cluster.

Wait some moments and now you can see your node added to the k8s cluster, bringing back to the controller/master and run:

```bash
sudo k0s kubectl get nodes
```

Copy your admin.conf in order to use kubectl directly:

```bash
sudo cp /var/lib/k0s/pki/admin.conf ~/admin.conf
export KUBECONFIG=~/admin.conf
```

Now you can run kubectl command without "sudo k0s"!

Additional configurations can be founded [here] (https://docs.k0sproject.io/latest/high-availability/) in official k0s doc page.

## Now you have your first kubernetes cluster !










